local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

local isMobile = UserInputService.TouchEnabled
local isPC = UserInputService.MouseEnabled

local savedKey = ""

local buttonSize = isMobile and UDim2.new(0, 80, 0, 80) or UDim2.new(0, 60, 0, 60)
local windowSize = isMobile and UDim2.new(0, 400, 0, 250) or UDim2.new(0, 350, 0, 200)
local panelSize = isMobile and UDim2.new(0, 350, 0, 400) or UDim2.new(0, 300, 0, 300)

local neonBlue = Color3.fromRGB(0, 150, 255)
local white = Color3.fromRGB(255, 255, 255)
local green = Color3.fromRGB(0, 255, 0)
local gray = Color3.fromRGB(100, 100, 100)

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MrMIXAILLUniversal"
screenGui.Parent = game:GetService("CoreGui")

local function makeDraggable(frame)
    local dragging = false
    local dragInput, dragStart, startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    
    if isPC then
        frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = input.Position
                startPos = frame.Position
                
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then
                        dragging = false
                    end
                end)
            end
        end)
        
        frame.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement then
                dragInput = input
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if input == dragInput and dragging then
                update(input)
            end
        end)
    else
        frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = frame.Position
            end
        end)
        
        frame.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.Touch then
                dragInput = input
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if input == dragInput and dragging then
                update(input)
            end
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.Touch then
                dragging = false
            end
        end)
    end
end

local mainButton = Instance.new("TextButton")
mainButton.Name = "MainButton"
mainButton.Size = buttonSize
mainButton.Position = UDim2.new(0.5, -40, 0.5, -40)
mainButton.BackgroundColor3 = Color3.new(0, 0, 0)
mainButton.Text = ""
mainButton.BorderSizePixel = 0
mainButton.ZIndex = 10
mainButton.AutoButtonColor = false

local buttonStroke = Instance.new("UIStroke")
buttonStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
buttonStroke.Color = neonBlue
buttonStroke.Thickness = 3
buttonStroke.Parent = mainButton

local letterM = Instance.new("TextLabel")
letterM.Name = "LetterM"
letterM.Size = UDim2.new(0, isMobile and 40 or 30, 0, isMobile and 50 or 40)
letterM.Position = UDim2.new(0.5, isMobile and -20 or -15, 0.5, isMobile and -25 or -20)
letterM.BackgroundTransparency = 1
letterM.Text = "M"
letterM.TextColor3 = white
letterM.TextScaled = true
letterM.Font = Enum.Font.SciFi
letterM.TextStrokeTransparency = 0
letterM.TextStrokeColor3 = neonBlue
letterM.Parent = mainButton

mainButton.Parent = screenGui
makeDraggable(mainButton)

local keyWindow = Instance.new("Frame")
keyWindow.Name = "KeyWindow"
keyWindow.Size = windowSize
keyWindow.Position = UDim2.new(0.5, -200, 0.5, -125)
keyWindow.BackgroundColor3 = Color3.new(0.05, 0.05, 0.05)
keyWindow.BackgroundTransparency = 0
keyWindow.Visible = false
keyWindow.ZIndex = 20

local keyWindowStroke = Instance.new("UIStroke")
keyWindowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
keyWindowStroke.Color = neonBlue
keyWindowStroke.Thickness = 3
keyWindowStroke.Parent = keyWindow

local keyCorner = Instance.new("UICorner")
keyCorner.CornerRadius = UDim.new(0, 12)
keyCorner.Parent = keyWindow

local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(1, 0, 0, 50)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = "MrMIXAILL"
title.TextColor3 = neonBlue
title.TextScaled = true
title.Font = Enum.Font.SciFi
title.TextStrokeTransparency = 0
title.TextStrokeColor3 = neonBlue
title.Parent = keyWindow

local keyInput = Instance.new("TextBox")
keyInput.Name = "KeyInput"
keyInput.Size = UDim2.new(0.8, 0, 0, isMobile and 50 or 40)
keyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
keyInput.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
keyInput.TextColor3 = white
keyInput.PlaceholderText = "Enter Key..."
keyInput.Text = ""
keyInput.ClearTextOnFocus = false
keyInput.TextScaled = true
keyInput.Parent = keyWindow

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 8)
inputCorner.Parent = keyInput

local getKeyButton = Instance.new("TextButton")
getKeyButton.Name = "GetKeyButton"
getKeyButton.Size = UDim2.new(0.8, 0, 0, isMobile and 50 or 40)
getKeyButton.Position = UDim2.new(0.1, 0, 0.6, 0)
getKeyButton.BackgroundColor3 = Color3.new(0, 0.2, 0.4)
getKeyButton.TextColor3 = white
getKeyButton.Text = "GET KEY"
getKeyButton.Font = Enum.Font.SciFi
getKeyButton.TextScaled = true
getKeyButton.AutoButtonColor = true
getKeyButton.Parent = keyWindow

local getKeyCorner = Instance.new("UICorner")
getKeyCorner.CornerRadius = UDim.new(0, 8)
getKeyCorner.Parent = getKeyButton

local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, isMobile and 40 or 30, 0, isMobile and 40 or 30)
closeButton.Position = UDim2.new(1, isMobile and -45 or -35, 0, 5)
closeButton.BackgroundColor3 = Color3.new(1, 0, 0)
closeButton.TextColor3 = white
closeButton.Text = "X"
closeButton.Font = Enum.Font.SciFi
closeButton.TextScaled = true
closeButton.Parent = keyWindow

local minimizeButton = Instance.new("TextButton")
minimizeButton.Name = "MinimizeButton"
minimizeButton.Size = UDim2.new(0, isMobile and 40 or 30, 0, isMobile and 40 or 30)
minimizeButton.Position = UDim2.new(1, isMobile and -90 or -70, 0, 5)
minimizeButton.BackgroundColor3 = Color3.new(1, 1, 0)
minimizeButton.TextColor3 = Color3.new(0, 0, 0)
minimizeButton.Text = "_"
minimizeButton.Font = Enum.Font.SciFi
minimizeButton.TextScaled = true
minimizeButton.Parent = keyWindow

keyWindow.Parent = screenGui
makeDraggable(keyWindow)

local scriptPanel = Instance.new("Frame")
scriptPanel.Name = "ScriptPanel"
scriptPanel.Size = panelSize
scriptPanel.Position = UDim2.new(0.5, -175, 0.5, -200)
scriptPanel.BackgroundColor3 = Color3.new(0.05, 0.05, 0.05)
scriptPanel.BackgroundTransparency = 0
scriptPanel.Visible = false
scriptPanel.ZIndex = 30

local scriptPanelStroke = Instance.new("UIStroke")
scriptPanelStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
scriptPanelStroke.Color = neonBlue
scriptPanelStroke.Thickness = 3
scriptPanelStroke.Parent = scriptPanel

local scriptCorner = Instance.new("UICorner")
scriptCorner.CornerRadius = UDim.new(0, 12)
scriptCorner.Parent = scriptPanel

local panelTitle = Instance.new("TextLabel")
panelTitle.Name = "PanelTitle"
panelTitle.Size = UDim2.new(1, 0, 0, 50)
panelTitle.Position = UDim2.new(0, 0, 0, 0)
panelTitle.BackgroundTransparency = 1
panelTitle.Text = "MrMIXAILL Scripts"
panelTitle.TextColor3 = neonBlue
panelTitle.TextScaled = true
panelTitle.Font = Enum.Font.SciFi
panelTitle.TextStrokeTransparency = 0
panelTitle.TextStrokeColor3 = neonBlue
panelTitle.Parent = scriptPanel

local panelCloseButton = Instance.new("TextButton")
panelCloseButton.Name = "PanelCloseButton"
panelCloseButton.Size = UDim2.new(0, isMobile and 40 or 30, 0, isMobile and 40 or 30)
panelCloseButton.Position = UDim2.new(1, isMobile and -45 or -35, 0, 5)
panelCloseButton.BackgroundColor3 = Color3.new(1, 0, 0)
panelCloseButton.TextColor3 = white
panelCloseButton.Text = "X"
panelCloseButton.Font = Enum.Font.SciFi
panelCloseButton.TextScaled = true
panelCloseButton.Parent = scriptPanel

local panelMinimizeButton = Instance.new("TextButton")
panelMinimizeButton.Name = "PanelMinimizeButton"
panelMinimizeButton.Size = UDim2.new(0, isMobile and 40 or 30, 0, isMobile and 40 or 30)
panelMinimizeButton.Position = UDim2.new(1, isMobile and -90 or -70, 0, 5)
panelMinimizeButton.BackgroundColor3 = Color3.new(1, 1, 0)
panelMinimizeButton.TextColor3 = Color3.new(0, 0, 0)
panelMinimizeButton.Text = "_"
panelMinimizeButton.Font = Enum.Font.SciFi
panelMinimizeButton.TextScaled = true
panelMinimizeButton.Parent = scriptPanel

local buttonStates = {}
local flyGUI = nil
local flyEnabled = false
local speedGUI = nil
local speedEnabled = false
local originalSpeed = 16
local noclipEnabled = false
local noclipConnection = nil
local infJumpEnabled = false
local antiAFKEnabled = false

local functions = {"fly", "speed", "noclip", "inf jump", "anti AFK"}

local function toggleFly()
    if flyEnabled then
        if flyGUI then
            flyGUI:Destroy()
            flyGUI = nil
        end
        flyEnabled = false
        
        local speaker = game:GetService("Players").LocalPlayer
        if speaker.Character and speaker.Character:FindFirstChildWhichIsA("Humanoid") then
            local humanoid = speaker.Character:FindFirstChildWhichIsA("Humanoid")
            humanoid.PlatformStand = false
        end
    else
        flyEnabled = true
        scriptPanel.Visible = false
        
        local main = Instance.new("ScreenGui")
        main.Name = "MrMFlyGUI"
        main.Parent = game:GetService("CoreGui")
        
        local Frame = Instance.new("Frame")
        Frame.Parent = main
        Frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Frame.BorderColor3 = neonBlue
        Frame.Position = UDim2.new(0.1, 0, 0.3, 0)
        Frame.Size = UDim2.new(0, 200, 0, 100)
        Frame.Active = true
        Frame.Draggable = true

        local flyLabel = Instance.new("TextLabel")
        flyLabel.Parent = Frame
        flyLabel.Size = UDim2.new(1, 0, 0, 30)
        flyLabel.Position = UDim2.new(0, 0, 0, 0)
        flyLabel.BackgroundTransparency = 1
        flyLabel.Text = "MrM FLY V3"
        flyLabel.TextColor3 = neonBlue
        flyLabel.TextScaled = true
        flyLabel.Font = Enum.Font.SciFi

        local closeFlyButton = Instance.new("TextButton")
        closeFlyButton.Parent = Frame
        closeFlyButton.Size = UDim2.new(0, 30, 0, 30)
        closeFlyButton.Position = UDim2.new(1, -35, 0, 5)
        closeFlyButton.BackgroundColor3 = Color3.new(1, 0, 0)
        closeFlyButton.TextColor3 = white
        closeFlyButton.Text = "X"
        closeFlyButton.TextScaled = true
        closeFlyButton.MouseButton1Click:Connect(function()
            toggleFly()
        end)

        flyGUI = main
        
        local speaker = game:GetService("Players").LocalPlayer
        local character = speaker.Character
        if character then
            local humanoid = character:FindFirstChildWhichIsA("Humanoid")
            if humanoid then
                humanoid.PlatformStand = true
            end
        end
    end
end

local function toggleSpeed()
    if speedEnabled then
        if speedGUI then
            speedGUI:Destroy()
            speedGUI = nil
        end
        
        local character = player.Character
        if character and character:FindFirstChildWhichIsA("Humanoid") then
            character:FindFirstChildWhichIsA("Humanoid").WalkSpeed = originalSpeed
        end
        speedEnabled = false
    else
        speedEnabled = true
        
        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "SpeedBoostGUI"
        screenGui.Parent = game:GetService("CoreGui")
        
        local frame = Instance.new("Frame")
        frame.Parent = screenGui
        frame.Size = UDim2.new(0, 300, 0, 200)
        frame.Position = UDim2.new(0.5, -150, 0.5, -100)
        frame.BackgroundColor3 = Color3.new(0.05, 0.05, 0.05)
        frame.AnchorPoint = Vector2.new(0.5, 0.5)
        frame.Active = true
        frame.Draggable = true

        local uiCornerFrame = Instance.new("UICorner")
        uiCornerFrame.CornerRadius = UDim.new(0, 12)
        uiCornerFrame.Parent = frame

        local title = Instance.new("TextLabel")
        title.Parent = frame
        title.Size = UDim2.new(1, 0, 0, 40)
        title.Position = UDim2.new(0, 0, 0, 0)
        title.BackgroundTransparency = 1
        title.TextColor3 = neonBlue
        title.Text = "MrM SPEED V1"
        title.TextScaled = true
        title.Font = Enum.Font.SciFi
        title.BorderSizePixel = 0

        local textBox = Instance.new("TextBox")
        textBox.Parent = frame
        textBox.Size = UDim2.new(0.8, 0, 0, 40)
        textBox.Position = UDim2.new(0.1, 0, 0.4, 0)
        textBox.PlaceholderText = "Enter Speed"
        textBox.Text = "50"
        textBox.TextScaled = true
        textBox.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
        textBox.TextColor3 = white
        textBox.Font = Enum.Font.SciFi
        textBox.BorderSizePixel = 0

        local uiCornerTextBox = Instance.new("UICorner")
        uiCornerTextBox.CornerRadius = UDim.new(0, 8)
        uiCornerTextBox.Parent = textBox

        local button = Instance.new("TextButton")
        button.Parent = frame
        button.Size = UDim2.new(0.8, 0, 0, 40)
        button.Position = UDim2.new(0.1, 0, 0.7, 0)
        button.Text = "Set Speed"
        button.TextScaled = true
        button.BackgroundColor3 = neonBlue
        button.TextColor3 = white
        button.Font = Enum.Font.SciFi
        button.BorderSizePixel = 0

        local uiCornerButton = Instance.new("UICorner")
        uiCornerButton.CornerRadius = UDim.new(0, 8)
        uiCornerButton.Parent = button

        local function updateSpeed()
            local speed = tonumber(textBox.Text)
            if speed then
                local character = player.Character or player.CharacterAdded:Wait()
                local humanoid = character:WaitForChild("Humanoid")
                humanoid.WalkSpeed = speed
            end
        end

        button.MouseButton1Click:Connect(updateSpeed)
        
        local closeButton = Instance.new("TextButton")
        closeButton.Parent = frame
        closeButton.Size = UDim2.new(0, 30, 0, 30)
        closeButton.Position = UDim2.new(1, -35, 0, 5)
        closeButton.BackgroundColor3 = Color3.new(1, 0, 0)
        closeButton.TextColor3 = white
        closeButton.Text = "X"
        closeButton.TextScaled = true
        closeButton.MouseButton1Click:Connect(function()
            toggleSpeed()
        end)

        speedGUI = screenGui
        
        local character = player.Character
        if character and character:FindFirstChildWhichIsA("Humanoid") then
            originalSpeed = character:FindFirstChildWhichIsA("Humanoid").WalkSpeed
            updateSpeed()
        end
    end
end

local function toggleNoclip()
    if noclipEnabled then
        if noclipConnection then
            noclipConnection:Disconnect()
            noclipConnection = nil
        end
        noclipEnabled = false
    else
        noclipEnabled = true
        noclipConnection = game:GetService("RunService").Stepped:Connect(function()
            if player.Character then
                for _, part in pairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
    end
end

local function toggleInfJump()
    if infJumpEnabled then
        infJumpEnabled = false
    else
        infJumpEnabled = true
        local connection
        connection = UserInputService.JumpRequest:Connect(function()
            if infJumpEnabled and player.Character then
                local humanoid = player.Character:FindFirstChildWhichIsA("Humanoid")
                if humanoid then
                    humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                end
            end
        end)
    end
end

local function toggleAntiAFK()
    if antiAFKEnabled then
        antiAFKEnabled = false
    else
        antiAFKEnabled = true
        local virtualUser = game:GetService("VirtualUser")
        game:GetService("Players").LocalPlayer.Idled:Connect(function()
            if antiAFKEnabled then
                virtualUser:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
                wait(1)
                virtualUser:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
            end
        end)
    end
end

for i, funcName in ipairs(functions) do
    local button = Instance.new("TextButton")
    button.Name = funcName
    button.Size = UDim2.new(0.8, 0, 0, isMobile and 50 or 40)
    button.Position = UDim2.new(0.1, 0, 0.15 + (i * 0.14), 0)
    button.BackgroundColor3 = gray
    button.TextColor3 = white
    button.Text = funcName:upper()
    button.Font = Enum.Font.SciFi
    button.TextScaled = true
    button.AutoButtonColor = true
    button.Parent = scriptPanel
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 8)
    btnCorner.Parent = button
    
    buttonStates[funcName] = false
    
    if funcName == "fly" then
        button.MouseButton1Click:Connect(function()
            toggleFly()
            buttonStates[funcName] = not buttonStates[funcName]
            if buttonStates[funcName] then
                button.BackgroundColor3 = green
                button.Text = "FLY ON"
            else
                button.BackgroundColor3 = gray
                button.Text = "FLY OFF"
            end
        end)
    elseif funcName == "speed" then
        button.MouseButton1Click:Connect(function()
            toggleSpeed()
            buttonStates[funcName] = not buttonStates[funcName]
            if buttonStates[funcName] then
                button.BackgroundColor3 = green
                button.Text = "SPEED ON"
            else
                button.BackgroundColor3 = gray
                button.Text = "SPEED OFF"
            end
        end)
    elseif funcName == "noclip" then
        button.MouseButton1Click:Connect(function()
            toggleNoclip()
            buttonStates[funcName] = not buttonStates[funcName]
            if buttonStates[funcName] then
                button.BackgroundColor3 = green
                button.Text = "NOCLIP ON"
            else
                button.BackgroundColor3 = gray
                button.Text = "NOCLIP OFF"
            end
        end)
    elseif funcName == "inf jump" then
        button.MouseButton1Click:Connect(function()
            toggleInfJump()
            buttonStates[funcName] = not buttonStates[funcName]
            if buttonStates[funcName] then
                button.BackgroundColor3 = green
                button.Text = "INF JUMP ON"
            else
                button.BackgroundColor3 = gray
                button.Text = "INF JUMP OFF"
            end
        end)
    elseif funcName == "anti AFK" then
        button.MouseButton1Click:Connect(function()
            toggleAntiAFK()
            buttonStates[funcName] = not buttonStates[funcName]
            if buttonStates[funcName] then
                button.BackgroundColor3 = green
                button.Text = "ANTI AFK ON"
            else
                button.BackgroundColor3 = gray
                button.Text = "ANTI AFK OFF"
            end
        end)
    end
end

scriptPanel.Parent = screenGui
makeDraggable(scriptPanel)

mainButton.MouseButton1Click:Connect(function()
    if savedKey == "9WSAD9mSCRIPTassets_thisISkey" then
        scriptPanel.Visible = true
        keyWindow.Visible = false
        mainButton.Visible = false
    else
        keyWindow.Visible = true
        mainButton.Visible = false
    end
end)

local function copyToClipboard(text)
    if isPC and setclipboard then
        setclipboard(text)
    else
        print("Link for manual copy: " .. text)
    end
end

getKeyButton.MouseButton1Click:Connect(function()
    copyToClipboard("https://link-hub.net/1405711/zEq7dPusRQtx")
end)

keyInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        if keyInput.Text == "9WSAD9mSCRIPTassets_thisISkey" then
            savedKey = keyInput.Text
            keyWindow.Visible = false
            scriptPanel.Visible = true
            mainButton.Visible = false
        else
            keyInput.Text = ""
            keyInput.PlaceholderText = "Wrong Key! Try Again"
        end
    end
end)

closeButton.MouseButton1Click:Connect(function() screenGui:Destroy() end)
panelCloseButton.MouseButton1Click:Connect(function() screenGui:Destroy() end)

minimizeButton.MouseButton1Click:Connect(function()
    keyWindow.Visible = false
    mainButton.Visible = true
end)

panelMinimizeButton.MouseButton1Click:Connect(function()
    scriptPanel.Visible = false
    mainButton.Visible = true
end)

mainButton.Visible = true
